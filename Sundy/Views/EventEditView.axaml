<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Sundy.ViewModels"
             x:Class="Sundy.Views.EventEditView"
             x:DataType="vm:EventEditViewModel"
             Width="600">
    
    <Border Background="White" 
            CornerRadius="8" 
            Padding="24"
            BoxShadow="0 4 16 #30000000">
        <Grid RowDefinitions="Auto,*,Auto">
            <!-- Header -->
            <TextBlock Grid.Row="0" 
                       Text="{Binding DialogTitle}"
                       FontSize="24"
                       FontWeight="SemiBold"
                       Margin="0,0,0,24"/>
            
            <!-- Form Content -->
            <ScrollViewer Grid.Row="1" MaxHeight="500">
                <StackPanel Spacing="16">
                    <!-- Blocking Event Warning -->
                    <Border IsVisible="{Binding IsEditMode}"
                            Background="#FFF3E0"
                            BorderBrush="#FFB74D"
                            BorderThickness="1"
                            CornerRadius="4"
                            Padding="12">
                        <TextBlock Text="{Binding BlockingSourceText}"
                                   TextWrapping="Wrap"
                                   FontSize="12"
                                   Foreground="#E65100"
                                   IsVisible="{Binding IsBlockingEvent}"/>
                    </Border>
                    
                    <!-- Title -->
                    <StackPanel Spacing="6">
                        <TextBlock Text="Title *" 
                                   FontWeight="SemiBold"
                                   FontSize="14"/>
                        <TextBox Text="{Binding Title}"
                                 Watermark="Event title"
                                 IsEnabled="{Binding !IsBlockingEvent}"/>
                    </StackPanel>
                    
                    <!-- Calendar Selection -->
                    <StackPanel Spacing="6">
                        <TextBlock Text="Calendar *" 
                                   FontWeight="SemiBold"
                                   FontSize="14"/>
                        <ComboBox ItemsSource="{Binding AvailableCalendars}"
                                  SelectedItem="{Binding SelectedCalendar}"
                                  IsEnabled="{Binding !IsBlockingEvent}"
                                  HorizontalAlignment="Stretch">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <Border Width="16" 
                                                Height="16" 
                                                Background="{Binding Color}"
                                                CornerRadius="3"/>
                                        <TextBlock Text="{Binding Name}" 
                                                   VerticalAlignment="Center"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </StackPanel>
                    
                    <!-- Date and Time -->
                    <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto,Auto" ColumnSpacing="12" RowSpacing="6">
                        <!-- Start Date/Time -->
                        <TextBlock Grid.Row="0" Grid.Column="0" 
                                   Text="Start Date *" 
                                   FontWeight="SemiBold"
                                   FontSize="14"/>
                        <DatePicker Grid.Row="1" Grid.Column="0"
                                    SelectedDate="{Binding StartDate}"
                                    IsEnabled="{Binding !IsBlockingEvent}"
                                    HorizontalAlignment="Stretch"/>
                        
                        <TextBlock Grid.Row="0" Grid.Column="1" 
                                   Text="Start Time *" 
                                   FontWeight="SemiBold"
                                   FontSize="14"/>
                        <TimePicker Grid.Row="1" Grid.Column="1"
                                    SelectedTime="{Binding StartTime}"
                                    IsEnabled="{Binding !IsBlockingEvent}"
                                    HorizontalAlignment="Stretch"/>
                        
                        <!-- End Date/Time -->
                        <TextBlock Grid.Row="2" Grid.Column="0" 
                                   Text="End Date *" 
                                   FontWeight="SemiBold"
                                   FontSize="14"
                                   Margin="0,12,0,0"/>
                        <DatePicker Grid.Row="3" Grid.Column="0"
                                    SelectedDate="{Binding EndDate}"
                                    IsEnabled="{Binding !IsBlockingEvent}"
                                    HorizontalAlignment="Stretch"/>
                        
                        <TextBlock Grid.Row="2" Grid.Column="1" 
                                   Text="End Time *" 
                                   FontWeight="SemiBold"
                                   FontSize="14"
                                   Margin="0,12,0,0"/>
                        <TimePicker Grid.Row="3" Grid.Column="1"
                                    SelectedTime="{Binding EndTime}"
                                    IsEnabled="{Binding !IsBlockingEvent}"
                                    HorizontalAlignment="Stretch"/>
                    </Grid>
                    
                    <!-- All Day Checkbox -->
                    <CheckBox Content="All day event"
                              IsChecked="{Binding IsAllDay}"
                              IsEnabled="{Binding !IsBlockingEvent}"/>
                    
                    <!-- Location -->
                    <StackPanel Spacing="6">
                        <TextBlock Text="Location" 
                                   FontWeight="SemiBold"
                                   FontSize="14"/>
                        <TextBox Text="{Binding Location}"
                                 Watermark="Add location"
                                 IsEnabled="{Binding !IsBlockingEvent}"/>
                    </StackPanel>
                    
                    <!-- Description -->
                    <StackPanel Spacing="6">
                        <TextBlock Text="Description" 
                                   FontWeight="SemiBold"
                                   FontSize="14"/>
                        <TextBox Text="{Binding Description}"
                                 Watermark="Add description"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 Height="100"
                                 IsEnabled="{Binding !IsBlockingEvent}"/>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
            
            <!-- Action Buttons -->
            <Grid Grid.Row="2" 
                  ColumnDefinitions="Auto,*,Auto,Auto" 
                  ColumnSpacing="10"
                  Margin="0,24,0,0">
                <!-- Delete Button (only in edit mode) -->
                <Button Grid.Column="0"
                        Content="Delete"
                        Command="{Binding DeleteCommand}"
                        Classes="danger"
                        IsVisible="{Binding IsEditMode}"/>
                
                <!-- Spacer -->
                <Panel Grid.Column="1"/>
                
                <!-- Cancel Button -->
                <Button Grid.Column="2"
                        Content="Cancel"
                        Command="{Binding CancelCommand}"
                        Classes="modern"
                        Width="100"/>
                
                <!-- Save Button -->
                <Button Grid.Column="3"
                        Content="{Binding SaveButtonText}"
                        Command="{Binding SaveCommand}"
                        Classes="accent"
                        Width="100"/>
            </Grid>
        </Grid>
    </Border>
</UserControl>

