<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:Sundy.ViewModels"
             x:Class="Sundy.Views.GeneralSettingsViewContent"
             x:DataType="vm:CalendarSettingsViewModel">
    <StackPanel Spacing="20">
        <!-- Header -->
        <TextBlock Text="General Settings"
                   FontSize="24"
                   FontWeight="SemiBold"
                   Foreground="{DynamicResource ForegroundPrimary}" />

        <!-- Calendar List -->
        <StackPanel Spacing="12">
            <TextBlock Text="Calendars"
                       FontWeight="SemiBold"
                       FontSize="16"
                       Foreground="{DynamicResource ForegroundPrimary}"
                       Margin="0,0,0,8" />

            <!-- Empty state -->
            <TextBlock Text="No calendars yet. Create one below."
                       Foreground="{DynamicResource ForegroundDisabled}"
                       FontStyle="Italic"
                       IsVisible="{Binding !Calendars.Count}" />

            <!-- Calendar items -->
            <ItemsControl ItemsSource="{Binding Calendars}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="8"
                                Padding="16"
                                Margin="0,0,0,8"
                                Background="{DynamicResource BackgroundSecondary}">
                            <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="Auto,*,Auto">
                                <!-- Calendar Color and Name -->
                                <Border Grid.Row="0" Grid.Column="0"
                                        Width="24"
                                        Height="24"
                                        Background="{Binding Color}"
                                        CornerRadius="6"
                                        VerticalAlignment="Center"
                                        Margin="0,0,12,0" />

                                <TextBlock Grid.Row="0" Grid.Column="1"
                                           Text="{Binding Name}"
                                           FontSize="16"
                                           FontWeight="SemiBold"
                                           Foreground="{DynamicResource ForegroundPrimary}"
                                           VerticalAlignment="Center" />

                                <!-- Delete Button -->
                                <Button Grid.Row="0" Grid.Column="2"
                                        Content="Delete"
                                        Command="{Binding DeleteCommand}"
                                        CommandParameter="{Binding}"
                                        Classes="danger"
                                        VerticalAlignment="Center" />
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </StackPanel>

        <!-- New Calendar Section -->
        <Border BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="0,1,0,0"
                Padding="0,20,0,0">
            <StackPanel Spacing="12">
                <TextBlock Text="Create New Calendar"
                           FontWeight="SemiBold"
                           FontSize="16"
                           Foreground="{DynamicResource ForegroundPrimary}" />

                <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                    <TextBox Grid.Column="0"
                             Text="{Binding NewCalendarName}"
                             Watermark="Calendar name"
                             Height="36" />
                    <Button Grid.Column="1"
                            Content="Create"
                            Command="{Binding CreateCalendarCommand}"
                            Classes="accent"
                            MinWidth="100" />
                </Grid>
            </StackPanel>
        </Border>

        <!-- Database Management Section -->
        <Border BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="0,1,0,0"
                Padding="0,20,0,0">
            <StackPanel Spacing="12">
                <TextBlock Text="Database Management"
                           FontWeight="SemiBold"
                           FontSize="16"
                           Foreground="{DynamicResource ForegroundPrimary}" />

                <TextBlock TextWrapping="Wrap"
                           Foreground="{DynamicResource ForegroundSecondary}"
                           FontSize="13"
                           Text="Warning: This will permanently delete all local data. This action cannot be undone." />

                <Button Content="Reset Database"
                        Command="{Binding ResetDatabaseCommand}"
                        Classes="danger"
                        HorizontalAlignment="Left"
                        MinWidth="150"
                        IsEnabled="{Binding !IsResettingDatabase}" />
            </StackPanel>
        </Border>
    </StackPanel>
</UserControl>
